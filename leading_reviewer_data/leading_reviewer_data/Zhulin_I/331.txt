As the protein sequence space grows, it becomes increasingly important to continuously improve and update natural classification of protein families. Makarova et al provide a unified classification for CRISP-associated (Cas) proteins and a scenario for the origins of CRISP-Cas. This work was carried out by employing a classical computational genomics approach based on analysis of protein sequences and structures. The subject of this paper is outside my immediate expertise and therefore I will not comment on its potential significance and impact for this field of CRISP-Cas systems and antiviral immunity in prokaryotes. Authors should rely on other reviewers in this regard. In my opinion, authors have provided essential background information about the systems and it was easy to follow the logic of their story. From the technical point of view, this is a well-executed study, which is not surprising considering authors' expertise and their standing in the field. However, the overall presentation is not as CRISP as the title might suggest. Papers presenting original research must provide enough detail, so results can be independently verified and reproduced, which is not the case here. This is primarily due to two issues that I have outlined below as major concerns.

MAJOR CONCERNS
1. Data and procedures are not described adequately. I will illustrate this point by a few examples taken from the very first section of Results & Discussion (pages 7 and 8): a. Authors state (lines 127-128): "... we performed exhaustive sequence database searches [IZ: which database? See also comment 2b] for all Cas protein families using the HHpred profile against profile search method". Does it mean "using sequences of representative members of these families?" As far as I understood, HHpred input requires a sequence, not a protein family, or a multiple sequence alignment. Therefore, authors should provide a list of all sequences that were used as queries in these HHpred searches, explaining why they were chosen (e.g. experimentally confirmed function, structure available, was previously predicted to be a Cas protein, etc) and providing corresponding references. They also should present the search result for each sequence, including the E-value and reported probability to be a false positive, similarly to the example shown on lines 130-134. A simple table in Excel would be a great choice to show these input data and search results. As it stands, I can only see input data and results for two sequences: ST0029 (line 130) and its reciprocal hit (line 133).

b. Authors state (lines 134-137): "We used the alignments obtained during these and other searches started from other query sequences along with secondary structure prediction to construct multiple alignments for Cas7 and a number of most closely related RAMP subfamilies (Figure ​(Figure1)".1)". What other searches? What other query sequences? Neither the follow-up text nor the figure legend for Figure ​Figure11 provides answers to these questions. Why these and not other sequences are shown on Figure ​Figure1?1? For example, Figure ​Figure4A4A shows at least two Cas7 genes in Staphylococcus epidermidis, but no sequences from this organism can be found on Figure ​Figure1.1. So, my guess is that Figure ​Figure11 shows representative sequences, but again this is just my guess. If it is so, why these sequences were selected as representative (e.g. to illustrate diversity or only highly scoring sequences are shown)? I cannot find any explanation anywhere in this paper. I was able to find one sequence from Staphylococcus epidermidis in Additional File 1 (which presumably contains the most comprehensive data). In accordance with Figure ​Figure4A,4A, this sequence is shown under Cas7 group. I have figured out this is the protein encoded by the second Cas7 gene from the cluster shown in Figure ​Figure4A4A (labeled as Csm5); however, there is no sequence for the protein encoded by the first Cas7 gene (Csm3) in the Additional File 1. Is this an error on Figure ​Figure4A4A or incomplete data representation in Additional File 1?

c. Authors state (lines 149-150): "Examination of this structure unequivocally demonstrates the presence of a single RAMP domain...[16]". Even if we ignore the wording (although I maintain a view that examination cannot demonstrate anything), it is unclear who came up with this conclusion: authors of the current paper or those who published the structure, without reading the structure paper. The continuation of this description (lines 150-152) is also confusing: "...a single RAMP domain that contains four inserts within the RRM core and a C-terminal extension. None of these additional domains of Cas7 show sequence or structural similarity to any known domains [16]". Is this a direct quote from reference 16? What is meant by "these additional domains"? Are the four inserts within a domain core and a C-terminal extension referred to as domains? Why, if they show no sequence or structural similarity to any known domains???

d. Authors state (lines 156-158): "We performed... HHpred searches using representatives of 19 RAMP families... (Additional File 1). What are these 19 families? I couldn't find any reference to them in the Background or in the Additional File 1, which contains over 30 individual MSAs and some of them are labeled as "family" (e.g. Cas6 family, the very last one), some are labeled as "subfamily" (e.g. Cas5 BF2549 subfamily), some are labeled as "group" (e.g. MTH323/Csm4 (Cas5 group)), and majority do not have labels that would identify them as a family (they have names, but are those family names?). Let us treat the first three lines of the Additional File 1 as its title (Please see TECHNICAL COMMENTS below regarding this file). It reads: "Cas7 group (COG1857 and other Cas7, COG1337/Csm3; COG1604/cmr6; COG1336/Cmr4; Csc2; Csf2; Csy3; Csm5 (COG1332), Cmr1 (COG1367, double Cas7). Let us assume that families are separated by comas and semicolons. Then there are 9 families in this group. Following the same assumption, there are 4 families in each of the Cas5 and Cas6 groups. I still cannot figure out what are the 19 families then. Perhaps, the first three lines of this file are not the title after all. This suspicion is confirmed by the main text (line 163), which lists 5 RAMPs in the Cas5 group (the 5th is Csy2, which is missing from the Cas5 description on the top of Additional File 1). The bottom line is that there is no place in the paper, where 19 families are clearly specified.

e. Returning to the main text (line 158): "... and collected similarity scores between corresponding profiles (Additional File 1)". I cannot see any similarity scores or any profiles in this file or anywhere else. I have stopped evaluating the adequacy of presentation after page 8, because it will require too much time, but I hope that authors will continue the trend I have initiated here and critically reevaluate their data presentation.

2. Methods are described at the very minimum. This section (half a page) looks like a methods summary, not methods description.

a. For PSI-BLAST, two search parameters were specified (page 34, line738), whereas no other details provided for any other type of analysis. If all parameters were default, it should be specifically stated.

b. There is a lack of consistency (and detail) in describing database search tools and databases. In one case, a search tool is specified (PSI-BLAST), but the database(s) is not (page 34, line737); whereas in the other case a database is specified (CDD), but the search tool (RPS-BLAST) and its parameters are not (page 34, line 740). No database is specified for HHpred searches (page 34, line 741).

c. Authors state (lanes 741-743): "Following the recommendations of the HHpred authors, we used the reported probability of a true positive match rather than the e-value to assess the statistical significance of a hit [27]". After reading the reference 27, I didn't get a sense that probability of a true positive match should be used instead of the E-value. Soding indeed writes that "E-values reported by most tools, including ours, can be very unreliable", but my take is that he suggests using the probability of a true positive match in addition to and not instead of the E-value.

In any case, at least one of these parameters must be provided for all search results (see comment 1a).

TECHNICAL COMMENTS
3. Additional File 1

a. What is shown in the Additional File 1? There is no title (I understand that the first 3 lines sort of serve the purpose of the title, but it is certainly not the title and they contain errors - see comment 1d) and no footnote explaining it.

b. Were these alignments automatically generated? It looks like a raw output file from some program or server. Reference to this file on page 8 (lines 156-159) is confusing: authors state that this is as a result of both DALI and HHpred searches. How so? Were DALI outputs used as inputs for HHPred? Full explanation of what is shown in this file is needed.

c. For some alignments, both 2D prediction and consensus are shown (e.g. Csy3), whereas for others only 2D prediction (e.g. Csb1, Cmr6) is shown. Is there any reason for that? No explanation is given to the fact that for some groups both 90% and 100% consensus are shown (e.g. Cmr4), whereas for others - only 85% consensus (e.g. Cas7 ygcJ). In some cases, results of 2D prediction and consensus are shown underneath the alignment (e.g. Csy3), whereas in other cases consensus is shown above and 2D underneath (e.g Cas7 (ygcJ). Amazingly, in some cases, 2D prediction is shown in the middle of the family alignment (e.g. Csb1). Is this all due to scripting errors? If so, how do we know whether in this case the upper part of the alignment is not in fact the bottom part of the alignment of another family shown above? This could have been a scripting error resulting in inserting a family id and some spacing in the middle of a family alignment... This inattention to the detail increases the probability of accidental errors and raises concerns.
