Diversity, Stability, and Reproducibility in Stochastically Assembled Microbial Ecosystems

ABSTRACT
Microbial ecosystems are remarkably diverse, stable, and usually consist of a mixture of core and peripheral species. Here we propose a conceptual model exhibiting all these emergent properties in quantitative agreement with real ecosystem data, specifically species abundance and prevalence distributions. Resource competition and metabolic commensalism drive the stochastic ecosystem assembly in our model. We demonstrate that even when supplied with just one resource, ecosystems can exhibit high diversity, increasing stability, and partial reproducibility between samples.

ARTICLE TEXT
Natural microbial ecosystems are remarkably diverse, often harboring hundreds to thousands of coexisting species in microscopic volumes [1–3]. How do these ecosystems manage to acquire and maintain such a high diversity? This so-called “paradox of the plankton” [4] is especially surprising given that microbes are capable of rapid exponential growth and fierce competition for nutrients. Indeed, the competitive exclusion principle [2,5] postulates that the number of species in an ecosystem at a steady state cannot exceed the number of available nutrients.

Compounding this puzzle, theoretical studies [6] suggest that highly diverse ecosystems are generally prone to instabilities. This brings up a second question: how do naturally occurring microbial ecosystems manage to remain relatively stable despite their diversity?

Moreover, ecosystems operating under similar environmental conditions could be rather different from each other in terms of species composition [3,7,8]. This apparent lack of reproducibility does not apply equally to different organisms. Some species, classified as “core’” or “keystone,” are detected in most individual ecosystems. Other “peripheral” species are only observed in a small fraction of them. Observed species’ prevalence distributions (the fraction of similar ecosystems a species is detected in) are often 
U shaped: their peaks occupied by these core and peripheral species, respectively [7]; often, these are also correlated with species abundances [8]. We are thus presented with a third question: what determines the reproducibility (or lack thereof) of species composition in microbial ecosystems?

Here, we introduce a conceptual model of a stochastically assembling microbial ecosystem, which in spite of its simplicity, addresses and suggests possible solutions to all three of these long-standing puzzles.

To explain the aforementioned high diversity and poor reproducibility, previous models have relied on a number of factors including spatial heterogeneity [5,9], temporal and seasonal variations in resource availability [10,11], thermodynamic constraints [12], microbial “warfare” and cooperation via ecological feedbacks [13], and predation by bacteriophages [14,15]. In contrast to this, our model attributes high diversity to metabolic by-products secreted by microbes due to incomplete resource-to-biomass conversion, which could in turn be used by other species for growth. By its very nature, our model simultaneously exhibits (i) high species diversity, (ii) gradually increasing stability—reached after repeated rearrangements, (iii) a 
U
-shaped prevalence distribution, and (iv) a positive abundance-prevalence correlation.

While our model clearly does not include many of the previously proposed factors known to affect these features, we believe it is a reasonable first order description of some real ecosystems, examples of which include the human oral microbiome [7], methanogenic bioreactors [16], and anaerobic digesters in wastewater treatment plants [3].

Our model describes a dynamic microbial ecosystem in which species attempt to populate the environment externally supplied with a single resource. We assume that species can convert only a fraction of consumed resources into their biomass, while secreting the rest as metabolic by-products. These in turn may serve as nutrient sources for other species in the ecosystem. This allows even one externally supplied resource to support high ecosystem diversity purely via by-product-driven commensal interactions.

New species are constantly introduced to this environment from some external population. Their survival or extinction is determined by a simple rule dictated by competitive exclusion. Because of the commensal relationship between these species, elimination of just one species may lead to an “extinction avalanche” in which multiple species are lost.

We explore how species diversity in microbial ecosystems is established over time. Moreover, by simulating several instances of ecosystem assembly, we can separate the set of core (high-prevalence) species from those with progressively lower prevalence.

The dynamics in our bioreactorlike environment is fully characterized by the concentrations of individual resources (metabolites) labeled as  and the abundances of all resident microbial species labeled as . When we initialize the model, each species is assigned a single resource it can grow on and  metabolic by-products. All resources are randomly selected from a “universal chemistry” of size . This choice is inspired by the total number of metabolites in KEGG’s metabolic database [17]. However, qualitatively similar results are obtained for much smaller values , for example, the number of carbon sources typically utilized by microbes.

The environment is supplied with a single resource (labeled 0) at a constant flux . After several attempts, the first microbial species (labeled 1) capable of utilizing the resource 0 colonizes the environment. The following equations determine the dynamical behavior of resource concentration and microbial abundance 

Here,  is the growth rate of the species 1 consuming the resource 0 at a rate where  is the yield of the biomass conversion process (microbial concentration per unit resource concentration). The resource affinity  is assigned by a random draw from a log-normal distribution such that the logarithm of  has mean 0 and variance 1.

Our model is based on carefully following the flow of resources (e.g., carbon) throughout the ecosystem. Different resources could be interconverted into each other and into the biomass of microbes. Hence it is convenient to measure all microbial abundances in units of the resource concentration. We adopt this change of units for  for the rest of this Letter. Microbial yield is given by  represents the fraction of the consumed resource (e.g., carbon atoms) successfully converted to biomass. The remainder is secreted as two by-products 1 and 2 getting shares , respectively.

Another interpretation of these equations would apply if all processes in the ecosystem were energy limited (as opposed to nutrient limited). In this case, it would be convenient to measure the concentrations of both resources and microbes in units of energy density. The factor ( ) could then be interpreted as an energy conversion efficiency. Because of dissipation, here it would be possible for (the fraction of the incoming energy flux secreted as by-products) to be smaller than the leftovers from biomass conversion. Barring small corrections, the results of our model would be equally applicable to such energy-limited ecosystems.

We assume that the concentrations of both microbes and resources are diluted at the same rate, . It is straightforward to generalize our model to a case where these dilution rates are in fact different (as is often the case in batch-fed bioreactors). Throughout this Letter we are only interested in the steady-state properties of the system, which can be easily derived from Eqs. (1) and (2). At steady state, and  are given by

Here, to simplify our notation, we have introduced the effective flux of a nutrient (adjusted for dilution), which is given by . Note that (a) at steady state, resource concentration  depends inversely on  implying that if two species were to compete for the same resource, the one with a higher  would drive the resource concentration lower than the other, thus being the only survivor of the two, and (b) unlike the steady-state nutrient concentration, the steady-state species abundance is largely independent of Indeed  only enters this equation via the effective resource flux which in the limit of low dilution approximates . Note that using a more general expression for microbial growth, e.g., the Monod equation, does not affect our results [18].

We simulate ecosystem assembly in discrete time steps corresponding to the introduction of a new microbial species into the ecosystem. We assume that these events are sufficiently infrequent for the system to reach steady state between two subsequent immigration attempts. We measure time in the number of attempted species immigrations. For a newly introduced species to survive, it must both have its consumed resource present in the ecosystem, and must also be most competitive on it, i.e., have the highest 

In this case, its steady-state abundance is determined by Eq. (4) but with the effective flux  of its consumed resource. If all by-products are equally partitioned, the average effective flux at trophic layer  is related to the external resource flux via

Note that if a new species competitively displaces another, any species that directly or indirectly depend on the latter for by-products could also go extinct. Very rarely, this extinction might be averted as long as at least one other resident species produces the same by-product and the remaining flux satisfies . As ecosystem assembly proceeds, we observe that the distribution of the number of species that go extinct during such events gets broader [see Fig. 1(c)]. Over many steps of ecosystem assembly, as species use and secrete more by-products, the entire ecosystem assumes a treelike structure [see Fig. 1(a) for ecosystem structure and Fig. 1(b) for sample dynamical trajectories].

Our model ecosystems have two interesting emergent features. First, species’ steady-state abundances follow a power law. Indeed, at trophic layer  a typical species’ abundance is determined by its consumed resource flux as . Each layer can accommodate species, where  is the number of by-products per species. We can show [18] that the species’ steady-state abundance distribution follows

A rank-abundance plot [see Fig. 2(a)] follows a power law with exponent . For appropriately chosen , both this expression and our simulations [solid curves in Fig. 2(a)] agree with data from microbial ecosystems sampled from the human tongue [7] and methanogenic bioreactors [16] [open circles in Fig. 2(a)].

Second, the dilution rate  sets a limit to the number of species in the ecosystem. This happens when the resource flux at the bottom-most layer  becomes negative [see Eq. (5)]. The number of species in the ecosystem [18] is proportional to  and given by

For and , , this expression [black solid line in Fig. 2(b)] approximates our simulated ecosystems [red solid line in Fig. 2(b)]. Note that this expression provides an upper bound to the number of species. It assumes both equal partitioning of all by-products and equal ’s for all species.

We now attempt to understand the reproducibility of species composition in similar ecosystems. For this, we first generate a “species pool” by running one instance of ecosystem assembly until it reaches 1000 species. Even transiently successful colonizers are added to this pool. We then simulate several instances of stochastic ecosystem assembly under identical initial conditions. Species attempt to colonize each ecosystem from the pool randomly (with replacement), with the assumption that each species has the same average immigration rate. The assembly process runs for a fixed time period measured by the number of per species immigration attempts.

After collecting several ecosystems for , we plot the distribution of species prevalence—the fraction of randomly assembled ecosystems in which a species is present [see Fig. 3(a)]. We observe that the shape of this distribution becomes more pronouncedly “  shaped” with increasing . For small values of  [Fig. 3(a), violet] the distribution is dominated by the species with small prevalence values. This indicates that for such short time of assembly stochastic species colonization dominates. For higher values of  (shown in green and red), the distribution is “ shaped”; i.e., most species are either core (found in most ecosystem instances) or peripheral (found in a small fraction of them). This can be explained as follows: as assembly proceeds, species from the pool which use high-flux resources with the largest resource affinities establish themselves at the top trophic layers. After some delay, other species from the pool that depend on these can successfully colonize middle trophic layers. However, stochastic colonization continues to dominate in the lowest trophic layers and contributes to the low-prevalence portion of the  shape. Such a -shaped prevalence distribution is observed in many real microbial communities: such as longitudinal samples of the human oral microbiome [7] [see the gray distribution in Fig. 3(b); the model prediction is shown in black for comparison] and anaerobic digesters in wastewater treatment plants [3].

Real ecosystems are often characterized by a positive correlation between the prevalence and relative abundance of species [see the scatter plot in Fig. 3(d) for oral microbiome and Fig. 2(b) in Ref. [3] for wastewater plants]. This observation is also captured well by our model: high-prevalence species tend to be consumers of resources at higher trophic layers and thus tend to be highly abundant [see model prediction in Fig. 3(c)].

To summarize, we present here a conceptual model of a microbial ecosystem which demonstrates some ecological consequences of metabolic facilitation—all of which are borne well by data from real ecosystems. What distinguishes our model from previous “consumer-resource” [10,20,21] approaches? First, we explicitly model energy conservation in the form of incomplete resource-to-biomass conversion and generate metabolic by-products from what remains. Second, we explicitly handle species abundances to explain why they scale according to a power law. Finally, we generate and explain species reproducibility from many microbial communities by simulating several stochastic assemblies.

Data from microbial ecosystems in different environments corroborate the overarching predictions of this model, namely: human oral microbiome samples [7], soil communities [8], wastewater treatment plants [3], and methanogenic bioreactors [16]. Interestingly, the oral data we use are from the human tongue, which is believed to be assembled in a specific temporal order; i.e., late-colonizing species depend on the ones that came before them [22]. This is very similar to the mechanism behind our simulations.

Note that our model contains a number of simplifying assumptions that are not realistic. (a) While energy is still strictly conserved in our model through balancing fluxes, we allow microbes to generate by-products with higher energy content (per molecule) out of resources with lower energy. However, the general direction of the metabolic flow in real biochemical pathways is down the energy gradient. We take this into account in model variant  [18] where metabolites are arranged in an energy hierarchy so that by-products always have lower energy content (per molecule) than their parent resource. (b) When generating new species, we assign their by-products randomly from a large set of possible metabolites. In reality, the number of possible metabolic pathways utilizing a given resource is smaller. For example, Ref. [12] lists 5 distinct glucose utilization pathways. We take this into account in model variant  [18] where each resource can be utilized via  distinct metabolic pathways, each producing its own set of  by-products. (c) Species consuming the same resource are thought to be subject to a “rate-yield trade-off” [10,23,24], which states that microbial species with faster growth rates on a given resource tend to use it less efficiently. Both model variants A and B [18] take this trade-off into account. Simulations from both variants show that our central results remain qualitatively unaffected by all these modifications [18].

Also note that we assume here that each microbe can use only one resource. In reality, microbes can typically use multiple resources for growth. However, such an extension involves several choices. First, one needs to decide if a microbe would consume resources in parallel or sequentially (both cases are observed in real microbes). Second, one may envisage trade-offs between resource affinity per resource and the number of resources. One extreme limit of this trade-off in which the sum of affinities always adds up to the same number has been recently modeled in Ref. [25]. We are currently considering alternative models which incorporate these choices.


