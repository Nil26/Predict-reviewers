Bayesian inference of negative and positive selection in human cancers

Abstract
Cancer genomics efforts have identified genes and regulatory elements driving cancer development and neoplastic progression. From a microevolution standpoint, these are subject to positive selection. Although elusive in current studies, genes whose wild-type coding sequences are needed for tumor growth are also of key interest. They are expected to experience negative selection and stay intact under pressure of incessant mutation. The detection of significantly mutated (or undermutated) genes is completely confounded by the genomic heterogeneity of cancer mutation1. Here we present a hierarchical framework that allows modeling of coding point mutations. Application of the model to sequencing data from 17 cancer types demonstrates an increased power to detect known cancer driver genes and identifies new significantly mutated genes with highly plausible biological functions. The signal of negative selection is very subtle, but is detectable in several cancer types and in a pan-cancer data set. It is enriched in cell-essential genes identified in a CRISPR screen2, as well as in genes with reported roles in cancer.

From an evolutionary perspective, cancer is a complex system that evolves asexually and is subject to antagonistic selective forces. Oncogenes and tumor suppressors evolve under strong positive selection when mutated and have been the prime target for cancer studies. In contrast, even though highly important for a full understanding of cancer vulnerabilities, negative selection has been an elusive phenomenon. Both positive and negative selection can be inferred by comparing the observed mutations at a given locus to the expectation under the sole action of the mutation process. However, this inference is entirely confounded by the variation in mutation rate along the cancer genome, and the concept of a constant background mutation rate has to be abandoned3. The problem is exacerbated by technical factors such as uneven sequencing coverage and mappability, as well as ploidy and purity of the samples. Initial approaches to address the problem of estimating the local background mutation rate relied on local gauging of mutation density by the observed number of neutral mutations. New methods to estimate local mutation rate, taking into account biological covariates such as replication timing, expression level, chromatin state or sequence context, have moved the field forward1. However, it is impossible to test whether local mutation rate estimates are exactly accurate at every locus. Even if errors in local mutation rate estimates are limited on average, they amplify in the case of extreme data points that masquerade as cancer driver genes. In contrast to point estimates, the statistical properties of the overall distribution of mutation densities can be fully validated with available data.

Using this concept, we present a probabilistic framework that addresses the problem of mutation rate variation, allowing for models that fit the observed data with high accuracy. Specifically, assuming that synonymous mutations evolve neutrally, we estimate the distribution of per-gene mutation probabilities by fitting synonymous mutation counts across the entire set of genes.

Here P(s|λs) is the probability of s synonymous mutations in a gene with gene-specific expectation λs (encapsulating local mutation density and synonymous target size). This probability is naturally modeled by the Poisson distribution. The expectation λs is assumed to be a random variable distributed according to P(λs|θ) (with parameter vector θ), which fully describes mutation rate heterogeneity and heterogeneity of mutation detection along the genome. For the specific assumption of gamma-distributed expected values, the observed counts s follow a negative binomial distribution, a special case presumed by Nik-Zainal et al.4 (see discussion in the Supplementary Note).

Importantly, equation (1) implicitly models all known and unknown covariates of mutation rate, making it independent of their separate knowledge or inference. When applying the equation to different cancer types, we thus obtain for each a parametric model of the distribution of per-gene mutation densities that provides an excellent fit to the observed synonymous counts and, therefore, a baseline to the analysis of selection. Using this baseline, we derive the expected distributions of the numbers of missense and nonsense mutations under neutral evolution. These distributions follow from a rescaling of λs with the per-gene ratio of nonsynonymous to synonymous target size, which takes into account the cancer-type-specific context dependence of mutations and does not require additional parameters. With sequence context explicitly accounted for, this approach represents a calibration of the conditions affecting mutations at a given gene, only assuming that every influencing local factor other than selection has a similar effect on synonymous and nonsynonymous variation (Supplementary Fig. 1; see the Supplementary Note for discussion).

Figure 1 shows the observed and expected neutral distributions in the three mutational categories—synonymous, missense (m), and nonsense (k) mutations—for head and neck squamous cell carcinoma (HNSC) (see Supplementary Figs. 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 for other cancer (sub)types). The synonymous count distribution was precisely fit (Fig. 1a). The best model for the distribution P(λs|θ) in this cancer was a mixture of an exponential component and an inverse gamma distribution component (Fig. 1b; model 4 in the Supplementary Note). The nonsynonymous count distributions, although relatively closely matching the neutral expectation, showed deviations suggesting the action of selection (Fig. 1c,d and Supplementary Table 1). When we extended the summation over tumor types to a pan-cancer analysis, enabling inferences about selective pressures acting across the entire range of cancer etiologies, we found a substantial signature of positive selection (Supplementary Fig. 26).

In combination with the observed count of synonymous mutations at each gene, the distribution P(λs|θ) opens up a Bayesian route to the estimation of per-gene probabilities for missense and nonsense mutations under the neutral evolution hypothesis. From this, we assess the deficit or excess in observed missense and nonsense mutations jointly in statistics φneg and φpos, which quantify the strength of negative and positive selection, respectively, at the gene level. Briefly, φ is a meta-statistic of P values (from m and k) similar to that obtained with Fisher's method, whose value increases with increasing selection (Online Methods and Supplementary Fig. 1). The observed distributions of φneg and φpos as well as the expectation under neutrality from simulation are shown in Figure 2a,b. From the distributions of φneg and φpos, we derive q values qneg and qpos, respectively, for each gene in each cancer type, which control the false discovery rate at q and are given in Supplementary Table 2. We call this method cancer Bayesian selection estimation (CBaSE).

Although signals of positive selection have been the primary instrument in identifying cancer drivers, detection of negative selection in tumors is arguably of equal importance. Negative selection aimed at conservation of genetic material is the dominant evolutionary mode across biological systems. Surprisingly, however, it has proven almost impossible to detect in cancer, although recent findings point in a new direction5,6,7,8. In part, the elusive nature of negative selection can be explained by sparsity of mutation data, which results in lower statistical power to show a significant deficit of mutations in comparison to a mutational excess. However, if negative selection is an important factor in cancer evolution, it may determine the dynamics of tumor progression and identify cancer vulnerabilities in the form of genes the tumor cannot afford to lose9.

Indeed, the genome-wide signal of negative selection appeared to be exceedingly weak in our analysis. In line with previous reports, we found it to be far less pronounced than the signal of positive selection on driver genes. However, we detected a significant negative selection signal in several cancer types and subtypes urothelial bladder carcinoma (BLCA), P = 8 × 10−3; colorectal cancer (CRC), P = 1 × 10−2; POLE-aberrant CRC (CRC_POLE), P = 3 × 10−2; melanoma (MEL), P = 3 × 10−6; uterine corpus endometrial carcinoma (UCEC), P = 5 × 10−8; UCEC no subtypes (UCEC_nosub), P = 2 × 10−2; POLE-aberrant (UCEC_POLE), UCEC P = 1 × 10−13; χ2 test; Supplementary Table 3), as well as in the pan-cancer data set (P = 4 × 10−4). Notably, these cancer types have high mutation densities, increasing the power of the analysis. Given that one of the potential causes of negative selection is the maintenance of genes that are responsible for basal cellular functions, we first compared CBaSE gene-specific predictions to the set of likely cell-essential genes from a cancer cell line knockout assay2. For 18 of the 25 cancer (sub)types and the pan-cancer data set, there was significant enrichment of our negative selection measure for cell-essential genes (5 × 10−6 ≤ PAUC ≤ 0.05; Fig. 2c (HNSC), Supplementary Figs. 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 and 27, and Supplementary Table 4). Notably, rank-based measures like the area under the receiver operating characteristic (ROC) curve (AUC) can be affected by variability in statistical power across genes (PAUC is corrected for this, and the neutral expectation is shown in the figures as a blue line; Supplementary Note).

Negative selection is also expected to act on neoantigens and oncogenes activated by noncoding or epigenetic driver events, expanding the scope of our predictions beyond cell essentiality10,11. Analysis of the cancer type with the strongest overall signal of negative selection, MEL, showed that, of the five most conserved genes, four have a reported oncogenic role in cancer (MKL1, NPY5R, RMDN2, and DIAPH1)12,13,14,15. Even in cancer types where we lacked power to detect a significant genome-wide signal of negative selection, strong biological candidates were found among the ten most highly protected genes across cancer types. For example, BCL2 (qneg = 0.03), BCL11B (qneg = 0.13), and PREX2 (qneg = 0.14), identified in diffuse large B cell lymphoma (DLBCL), chronic lymphocytic leukemia (CLL), and esophageal cancer (ESO), respectively, are either established apoptosis suppressors in the corresponding cancer types or tumor-suppressor inhibitors16,17,18. To concentrate on functionally important genes under negative selection, we selected the subset of genes with qneg <0.6 (n = 421) that also showed significantly increased expression in tumor versus normal tissue in at least 50% of available cancer tissues or are likely cell essential (CRISPR score < 0 or GTS (gene-trap score) < 0.2 from Wang et al.2; Supplementary Table 5). Clustering this subset of 88 (21%) genes putatively indispensable in cancer by functional annotation using DAVID, we found enrichment for proteins involved in RNA processing (group enrichment score (ES; geometric mean of negative log-transformed P values in an annotation cluster) = 2.1; Supplementary Table 6). Supplementary Table 7 shows the per-gene estimates of negative selection inferred from the pan-cancer analysis. Here, among 13 genes with qneg <0.4, we found 6 (46%) cancer-promoting genes (ATAT1, BCL2, CLIP1, GALNT6, CKAP5, and REV1)17,19,20,21,22,23.

Next, we applied CBaSE to detect cancer driver genes, the long-standing area of method development in cancer genomics. Figure 2d (HNSC) and Supplementary Figures 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 and 27 show that the method had high sensitivity in recovering known cancer-type-specific genes listed in the Catalogue of Somatic Mutations in Cancer (COSMIC) Cancer Gene Census (CGC)24 for the 17 original cancer types and 8 subtypes, as well as for the pan-cancer data set (0 ≤ PAUC ≤ 0.04; Supplementary Table 4; Supplementary Figs. 28 and 29 show corresponding precision–recall curves). The AUC exceeded that of the covariate-clustering-based algorithm MutSigCV1 (run with default mutation rate covariates) for HNSC and in aggregate (for 21 of 25 cancer (sub)types). The performance of CBaSE depends on the availability of synonymous mutations, and the four cancer types for which it currently does not outperform MutSigCV indeed had the fewest synonymous mutations (prostate adenocarcinoma (PRAD), CLL, acute myeloid leukemia (LAML), and multiple myeloma (MM)). To prioritize genes under positive selection further, we derived properties expected from cancer driver genes, such as clustering of missense alterations in 3D protein structures (according to the algorithm mutation3D) and aberrant expression in cancers (Supplementary Table 8).

Overall, of the 58 genes that had qpos <0.002 in any of the cancer types, 74% (n = 43) are already listed in the CGC. Among the 15 remaining strongest novel driver candidates, we found 6 genes that have previously been associated with tumorigenesis (ARHGAP35, TRAF3, EPHA2, AJUBA, RBL2, and MED23)4,25,26,27,28,29. In the larger group of 452 non-CGC candidate driver genes with qpos <0.1, 32% (n = 144) had either largely reduced expression in cancer tissues relative to primary cells or oncogenic features (largely elevated expression or missense mutation clusters with P < 0.1). These genes showed a strong enrichment for cell adhesion and cell morphogenesis (ES = 5.9 and 4.3, respectively; Supplementary Table 9), consistent with typical targets for positive selection in cancer. Genes with highly significant signals of positive selection from the pan-cancer analysis replicated many of the findings for individual cancer (sub)types (Supplementary Table 10). Of the 36 pan-cancer genes with qpos = 0, 35 (97%) are listed in the CGC. The remaining gene, ARHGAP35, has been implicated as a cancer driver25.

From the distributions of φ shown in Figure 2a,b and Supplementary Figures 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 and 27, we inferred lower bounds on the genome-wide fractions of genes under negative and positive selection. The minimum fraction of negatively selected genes varied from 0 to 1.3% across individual cancer (sub)types, while positive selection acted on 0.05 to 4.7% of genes (Fig. 3 and Supplementary Table 3). In the pan-cancer data set, at least 5.4% of genes appeared to be under positive selection and 0.4% of genes appeared to be under negative selection, which is broadly compatible with findings from a recent study8.

Unlike in most other biological systems, detection of negative selection in cancer is a formidable task. Besides the fact that negative selection coefficients may on average be small because of the dispensability of most of the gene repertoire for cancer cell survival, their impact of negative fitness effects is also often weakened by strongly selected driver mutations drawing deleterious passenger mutations to fixation9,30,31. Also, most mutations in our analysis are heterozygous, and many cell-essential genes seem to be haplosufficient2,7. Conversely, positive selection on synonymous variation in oncogenes would contribute to the signal32. Lastly, detectability of significant hypomutation is constrained by mutation data availability, necessitating fine-tuned approaches to separate signal from noise. The inference of selection is generally also complicated by the possible presence of unfiltered germline variants in cancer sequencing data, statistical uncertainty in the inferred context-dependent mutation models, and heterogeneity in the context dependence of mutations along the genome (Supplementary Figs. 30 and 31, and Supplementary Note). With the rapidly growing number and size of cancer sequencing data sets, hierarchical models can be adopted to incorporate the uncertainty for many underlying biological and technical variables. These methods may boost power for cancer driver detection and identify negative selection to help find genes indispensable for cancer.

Methods
Data sets.
We analyzed 17 cancer types with a total of 4,476 patients from the published Tumor Portal data set33 (http://www.tumorportal.org/): urothelial bladder carcinoma (BLCA), breast invasive carcinoma (BRCA), chronic lymphocytic leukemia (CLL), colorectal cancer (CRC), diffuse large B cell lymphoma (DLBCL), esophageal cancer (ESO), glioblastoma multiforme (GBM), head and neck squamous cell carcinoma (HNSC), kidney renal clear cell carcinoma (KIRC), acute myeloid leukemia (AML), lung adenocarcinoma (LUAD), lung squamous cell carcinoma (LUSC), melanoma (MEL), multiple myeloma (MM), ovarian cancer (OV), prostate adenocarcinoma (PRAD), and uterine corpus endometrial carcinoma (UCEC). Four additional cancer types (carcinoid, medulloblastoma, neuroblastoma, and rhabdoid tumors) were omitted because of their low overall mutation counts. Breast (BRCA), colorectal (CRC), and endometrial (UCEC) cancers were further subdivided into common subtypes: ER-positive (ERpos) and ER-negative (ERneg) cases for breast cancer, and for colorectal and endometrial cancers polymerase ɛ–aberrant (POLE) and mismatch-repair-deficient (MMR) subtypes, and samples belonging to neither of these categories (nosub) (Supplementary Table 11).

The Tumor Portal data set is filtered for germline variants33. To quantify potential contamination with germline polymorphism in more detail, we compared the expected and observed fractions of somatic mutations overlapping with known SNPs (Supplementary Note). We found a high correspondence, suggesting that germline contamination (or overfiltering) in the data set is very low (Supplementary Fig. 30). Exonic mutations that were not located in one of 575 known cancer-related genes in the CGC24 (v80) or in one of 77 likely cell-essential genes from Wang et al.2 were used in the derivation of the nucleotide-context-dependent mutation signature matrix, which determines the expected number of mutations under the null model of neutral evolution. We used a set of 18,666 genes from the UCSC knownGene track, omitting olfactory receptor genes, which cluster anomalously around a gene length of 945 bp (Supplementary Table 12).

Predicted negatively selected genes were compared to likely cell-essential genes2 (Supplementary Table 13). For a naive ranking of cell-essential genes according to mutation paucity across all mutation classes (m,k,s), we find PAUC < 0.05 (≤0.002) for 6 (2) of the 25 cancer (sub)types, showing that enrichment of the negative selection signal with cell-essential genes is not driven by general hypomutation (Supplementary Table 4). To assess the sensitivity of our positive selection estimates, we tested prediction of cancer-type-specific causally implicated genes from the CGC (Supplementary Table 14). We compared the sensitivity to that of the algorithm MutSigCV1 (v1.2), which is based on clustering genes with respect to mutation rate covariates (Supplementary Table 15). In addition to the ROC curves shown in Figure 2 and Supplementary Figures 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 and 27, we derived precision–recall curves, which are presented in Supplementary Figures 28 and 29. Prediction of clustering for missense alterations was performed using the algorithm mutation3d34 (http://www.mutation3d.org/) with preset cluster criteria. Tumor–normal gene expression levels were obtained from the TCGA Expression Browser (https://tools.altiusinstitute.org/tcga/) for 22 cancer types. Functional annotation clustering of Gene Ontology biological process terms (GOTERM_BP_FAT) was performed using DAVID35 (v6.7; http://david.ncifcrf.gov/) with default clustering criteria.

Expected distribution of synonymous mutation counts.
Assuming that the synonymous class of mutations evolves neutrally, we model the observed count of synonymous mutations per gene s as a Poisson random variable with expectation λs. This expectation is dependent on the synonymous mutation rate at the gene locus, gene length, and the tumor lifetime in generations (Supplementary Note). The aim of our probabilistic approach is to infer P(λs|θ), that is, the distribution of λs, across the entire ensemble of genes. Importantly, P(λs|θ) by construction captures genome-wide mutation rate heterogeneity that is due to, for example, replication timing, expression level, chromatin state, tumor subclonality, and purity or ploidy of the sample, and hence does not depend on explicit knowledge thereof (Supplementary Table 16). Summing all synonymous mutations per gene locus over all tumors of a given cancer type, we can write the expected distribution of s as in equation (1). We then fit this neutral model to the observed distribution of the synonymous count per gene s to estimate the parameters θ of the genome-wide distribution of the expected number of synonymous mutations, P(λs|θ) (Fig. 1a).

Parametric form of P(λs|θ).
The functional form of P(λs|θ) is not known a priori; however, the main parameter to affect the expected number of synonymous mutations for a given gene is the synonymous target size, which in turn is proportional to the coding-sequence length. Furthermore, we cannot assume that all genes were necessarily covered in the DNA sequencing of a given cancer type, resulting in an inflated weight of λs around zero. This motivates the space of parametric functions we explore to describe the genome-wide distribution of λs. Briefly, we test six linear combinations of gamma and inverse gamma distributions (Supplementary Note). The optimal functional form for each cancer type is then selected from the AIC-penalized log likelihoods. We found that all 17 cancer types could be fit by a linear combination with an inverse gamma distribution component (Fig. 1b and Supplementary Figs. 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 and 26).

Expected distribution of nonsynonymous mutation counts under neutrality.
The inferred  enables derivation of the corresponding distributions in the nonsynonymous mutation categories expected under neutral evolution, which in turn permit detection of signatures of selection. We derive the distributions for missense (m) and nonsense (k) mutation counts from a rescaling of the synonymous Poisson parameter λs by the ratio of nonsynonymous to synonymous target size, rx (Fig. 1c,d).

The target size for a given gene depends on the coding-sequence composition in conjunction with the cancer-type-specific mutational signature, which we infer from observed coding-sequence mutations outside of the set of likely selected genes (Supplementary Note).

Per-gene selection inference.
To quantify selection at the level of individual genes, using , we derive a Bayesian expression for the posterior probability of the observed nonsynonymous mutation count x given the observed s.


This allows corresponding P values to be computed for each gene, where negative selection is quantified by hypomutation in either nonsynonymous category ( and ) and positive selection in driver genes is marked by hypermutation ( and ) (Supplementary Note). We combine the P values from the observed missense and nonsense counts for each selection scenario into a meta-statistic φ, analogous to Fisher's method.

Large values of φ indicate small P values and hence strong selection. Using simulated count data generated under the null model of neutral evolution, we then compute the significance of the observed φ statistic, resulting in q values for each gene in each selection category (negative or positive), which control the false discovery rate at q.

Inference of the selected fraction and significance of the genome-wide selection signal.
The observed excess in the distributions of the meta-statistics φpos and φneg is used to derive a lower bound on the genome-wide fractions of genes under positive and negative selection, respectively. To this end, we compute the difference between the cumulative probabilities contained in the large-φ tail of the observed and simulated distributions, making this a conservative estimate. To assess the significance of the genome-wide signals of selection, we perform a χ2 goodness-of-fit test on the region defined by the highest percentile of the simulated φ values in each cancer type (Supplementary Table 3).

Code availability.
A user interface that allows the cBaSE method to be run with user-provided somatic mutation data can be found at http://genetics.bwh.harvard.edu/cbase. In addition, the code can be downloaded from the same site.
