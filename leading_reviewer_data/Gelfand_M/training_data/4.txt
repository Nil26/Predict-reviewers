Evolution of transcriptional regulatory networks in microbial genomes
Advances in sequencing and generating high-throughput expression data have created a situation in which it is possible to integrate comparative analysis with genome-wide studies of the structure and function of regulatory systems in model organisms. Recent studies have focused on topological properties and the evolution of regulatory networks. This problem can be addressed on several levels: evolution of binding sites upstream of orthologous or duplicated genes; co-evolution of transcription factors and the DNA motifs that they recognize; expansion, contraction and replacement of regulatory systems; the relationship between co-regulation and co-expression; and, finally, construction of evolutionary models that generate networks with realistic properties. This should eventually lead to the creation of a theory of regulatory evolution with a similar level of detail and understanding to the theory of molecular evolution of protein and DNA sequences.

Introduction
Regulation of gene expression is arguably one of the fastest developing areas of bioinformatics. There are two main reasons for this. Firstly, the number of sequenced genomes (hundreds of bacteria, dozens of archaea and yeasts) makes it possible to perform a wide variety of comparative studies. Secondly, advances in experimental techniques lead to the production of large amounts of non-genomic data that enable one to study whole networks, rather than individual systems, and place them in a cellular context. Here, I aim to review recent advances in the analysis of transcriptional regulation, and discuss the possible integration of functional and evolutionary approaches (Figure 1). I consider only microbial genomes, although developments concerning multicellular organisms are no less exciting. For example, large-scale studies of microRNA and their targets revealed a major, only recently appreciated, system of regulation. Large-scale mapping of promoters in conjunction with analysis of gene expression data obtained using microarrays and global transcriptome data obtained using tiling arrays pave the way for detailed studies of transcriptional regulation. In addition, the sequencing of many genomes from relatively narrow taxonomic groups, such as fruit flies and mammals, especially under the ENCODE project (http://genome.ucsc.edu/ENCODE/), enables large-scale comparative studies.

Structure and function of regulatory networks
Repertoire
Transcription factors (TFs) form one of the largest functional protein groups in most genomes. As demonstrated by Stover et al. [1] and, for a larger data set, by van Nimwegen [2], the fraction of TFs in bacterial genomes scales approximately as the square of the total gene number of a genome: that is, doubling of the genome complement size leads to quadrupling of the TF repertoire. Although it is clear that this behavior theoretically cannot be maintained indefinitely, there are no signs of saturation for larger genome sizes, reaching, for the largest genomes, 9.4% in Pseudomonas aeruginosa [1] and 12.3% in Streptomyces coelicolor [3].

The contribution of particular TF families to this diversity is very uneven. In Escherichia coli, 271 TFs form 11 classes, as defined by the structure of their DNA-binding domain, which are further subdivided into 74 families of paralogs based on their domain architecture [4]. The largest TF family in E. coli is LacI, with up to 100 representatives (but see below). However, in other genomes, the prevalence of TF families is different. Just by looking at clusters of orthologous groups, one can roughly define several types of TF families. In many cases (NrdR, HrcA, ArgR), an almost ubiquitous TF family forms a perfect group of orthologs, with a single representative in each genome and no indication of duplications. Some such factors (BirA, ModE) are also present in archaea. As shown by comparative genomic analysis, the binding motifs of such factors tend to be conserved, although in some cases there is a complete change in the binding motif of orthologous factors (e.g. DinR in the Bacillus/Clostridium group and LexA in proteobacteria). One further strategy is to have a small number of TF family representatives per genome, as exemplified by the CRP/FNR and FUR families. Finally, there are families that demonstrate a burst of activity in certain taxa, for example, the LacI family in many α- and γ-proteobacteria (O Laikova, personal communication), the LysR family in E. coli [5], two-component systems in Desulfovibrio spp (E Permina, personal communication) and sigma-factors in Streptomyces spp [3]. One reason for this may be that TFs from the same family tend to perform specific, related functions (e.g. regulation of sugar catabolism for LacI and GntR, redox state sensing for FNR, metal ion homeostasis for FUR) and therefore the prevalence of a family in a genome indirectly reflects its lifestyle.

Networks
Advances in experimental techniques, specifically ChIP-chip analysis (an oligonucleotide-array-based technique for the large-scale identification of protein–DNA interactions), enabled a more or less complete elucidation of the yeast transcriptional regulatory network [6]. The number of promoters per regulator ranges from 0 to 181 (for the Abf1 TF) and the distribution follows a power law, with an average of 38 promoters per regulator. For comparison, analysis of the YPD database of yeast promoters (compiled from the literature) produced an average of 10 and a maximum of 72 promoters per regulator [7]. In contrast, the number of regulators per promoter seems to follow an exponential distribution, with the observed maximum of 21. Similar observations have been made for the E. coli regulatory network based on analysis of the literature data: the power law distribution with the maximum of 85 regulated genes per TF and the exponential distribution with up to 6 TF per promoter. About two-thirds of the E. coli and four-fifths of the yeast interactions are activations.

However, these numbers have to be considered as preliminary, as it is clear that further work will produce more data. A slightly more recent study of E. coli regulation using essentially the same type of data produced maxima of 197 sites per TF and 7 TFs per regulated operon [4], whereas a recent large-scale run-off transcription/microarray analysis (ROMA) identified 192 CRP-regulated operons, which contain about 300 genes [8]. The latter study also demonstrated that all methods tend to miss some sites and thus the actual number of CRP-regulated operons may be even larger (Figure 2).

Development of network motif analysis has taken two directions. One is the detailed analysis of transcriptional motifs, mainly the most over-represented one, the feed-forward loop (FFL): T → S → G, T → G, where T and S are transcription factors, and G is a gene. In particular, when the mode of regulation is taken into account, two types of FFLs (out of eight possible) turn out to be the most frequent both in E. coli and in yeast: an activation cascade, T → ⊕S → ⊕G, T → ⊕G, which delays the activating response of G to the stimulation of T if both factors (T and S) are needed for the expression of G; and T → ⊕S → ∅G, T → ⊕G, which accelerates the response of G to the stimulation of T in the absence of the stimulation of S, and represses the response if S is stimulated (⊕ and ∅ denote activation and repression, respectively, upon stimulation) [9]. The prevalence of certain types of motifs, in particular FFLs, has been linked to their dynamic properties: more prevalent motifs are those that lead to stable behavior under a larger set of repression/activation constants [10]. However, it is not immediately clear whether the latter study accounted for the following trivial explanation: among motifs formed by the same number of genes and interactions, relatively unstable (and infrequent) motifs are simply those that contain more TFs as vertices (as various loops are required for instability), whereas motifs with a relatively larger fraction of non-TF genes are more frequent simply because non-TF genes (terminal nodes in the transcription network) are more frequent than TF genes.

Analysis of the network context demonstrates that FFLs comprise just a few connected components of two types: both T and S regulate a large number of genes (e.g. the aerobic/anaerobic switch regulated by FNR → ArcA and the flagellar motor regulon); or T is a global regulator that influences a large number of local systems, each with its own local regulator (e.g. CRP and sugar catabolism repressors) [11].

Another direction is integration of diverse networks, putting transcriptional regulation into a functional framework. Simultaneous analysis of transcriptional regulation, protein–protein interactions, homology, co-expression and synthetic lethals in yeast revealed a number of over-represented motifs, most of which have a clear biological interpretation [12•]. Some of these motifs are FFLs; interacting TFs regulating the same gene; TFs regulating interacting and/or co-expressed genes; homologous TFs regulating same gene; and finally TFs regulating homologous genes. Again, it should be emphasized that the motifs do not exist in isolation, but rather form large ‘themes’, mainly by multiplication of the regulated genes. Some examples are multiple FFLs with the same pair of interacting TFs; interacting TFs and a large regulon; TF and its regulon, whose members are co-expressed and/or form a protein complex (Figure 3, top row).

The next important step was to incorporate data on upstream signaling pathways. This became possible after the development of high-throughput methods for the identification of phosphorylation targets on proteome chips [13•]. Again, some motifs are over-represented in the resulting network (Figure 3, bottom row). How these simple motifs interact within a larger map remains to be analyzed.

Co-regulation and co-expression
Large sets of expression data and a surge in the development of clustering algorithms for the identification of co-expressed genes immediately raised the question of how well the constructed clusters approximate co-regulation. Comparison of co-expression clusters with a database of TF-binding sites and ChIP data on protein–DNA interactions demonstrated that the measure of overlap between these clusters and regulons stabilizes in the interval between 50 and 100 microarray experiments, but both false-negative and false-positive rates remain rather high [14]. Only about 20% of binding sites identified in the literature are recovered in ChIP experiments; on the other hand, at most 28% of genes in one cluster share at least one TF. However, this analysis did not take into account the nature of regulation; it had been demonstrated that only co-activated genes tend to be co-expressed in a large variety of conditions, whereas co-repressed genes may shut down simultaneously, but are uncorrelated otherwise [15]. It might be interesting to see whether it is possible to predict whether a TF is an activator or a repressor (given DNA-binding data) based on the difference between the modes of behavior of regulated genes.

Another way to integrate expression and regulation data is to identify regulatory interactions that are active in various conditions [16•]. For any given condition, a gene was assumed to be active if its expression changed in this condition; a TF regulating an active gene was assumed to be active if it was expressed at a significant level and this procedure was iterated, activating additional TFs, until convergence. At the end, only the links between active genes were retained, producing an active subnetwork. It turned out that the structure of the active subnetwork depends on the experimental conditions. In ‘endogenous’ conditions (cell-cycle phases, sporulation), complex TF combinations were revealed, with few targets per TF, relatively many TFs per target, long paths, high clustering coefficients, many connections between TFs and, in particular, many FFLs. In ‘exogenous’ conditions (diauxic shift, DNA damage, environmental stress), there were few connections between TFs, many targets per factor and most genes were regulated by a single TF.

Evolution
Duplications within genomes
In several studies, it has been observed that paralogous TFs tend to regulate paralogous genes, both in E. coli [4, 16•] and in yeast [12•, 17]. This has been considered evidence that transcriptional regulatory networks tend to evolve by duplication and, indeed, a simple duplication-based model is sufficient to explain the observed scaling of TF number with genome size and the distribution of the node degrees in the transcriptional network [18]. However, although there are numerous obvious examples of recently duplicated TFs and their targets, another explanation might be massive horizontal transfer of fragments containing both regulated genes and their regulators. Indeed, recent horizontal transfers of bacterial enzymes outnumber duplications by about tenfold [19].

One of the main sources of examples of coordinated TF and target gene duplications in bacteria are the carbohydrate catabolism regulons. However, it looks like the main mode of introduction of new catabolic pathways is the LEGO-like construction of new operons from pre-existing components rather than simple duplication of entire operons (O Laikova, personal communication). As such, TFs, transporters and enzymes in functionally similar pathways may belong to different non-homologous families, creating numerous instances of non-orthologous gene displacement. Although this observation may be difficult to quantify, support comes from the fact that the TF content of close strains may be considerably different. For example, there are 100 groups of orthologous TFs from the LacI family in seven Escherichia and Shigella spp genomes, but only 46 of them occur in all seven genomes and a single genome contains 69–88 TFs; similarly, there are 72–80 representatives out of 91 possible in five Salmonella spp genomes and 36–43 out of 49 in four bacteria from the Bacillus cereus group (Figure 4) (O Laikova, personal communication).

In another series of studies, the divergence in regulation and/or expression of recently duplicated yeast genes was considered. The co-expression of paralogs was shown to deteriorate rather rapidly: 40% of paralogs show lack of co-expression even at a rather close evolutionary distance (synonymous substitution rate Ks < 0.10) and more than 80% of paralogs with Ks > 1.5 are not co-expressed [20]. A similar trend is seen when the non-synonymous substitution rate, Ka, is used as the measure of evolutionary distance, but only for the initial segment of Ka values (Ka < 0.30). Rapid loss of coincidence of predicted TF-binding sites was demonstrated in [21]. However, the loss of 3% of experimentally determined sites for common TFs per 1% amino acid divergence was observed in [22]; this coincides nicely with the above observations, as it means that, at Ka ∼0.3, almost all common sites would be lost.

As it has been recently demonstrated that a large fraction of the yeast paralogs arose from whole-genome duplication [23], it would be interesting to compare the pattern of site loss and expression change in surviving descendants of this duplication (in this case, the post-duplication time is the same for all pairs, and it is possible to check whether there is a correlation between the rate of sequence and regulatory evolution) and in the paralogs arising from local duplications. One could expect that the reasons for retention of duplicated genes following global duplication and local duplication might be different.

No systematic studies of this kind were done in bacteria, although some observations have been made in the course of comparative analyses. One such observation is the rapid divergence after duplication of the ribose repressor in the common ancestor of Enterobacteriaceae, Vibrionaceae and Pasteurellaceae (M Gelfand, unpublished). One lineage, the purine repressors (PurR), retained the DNA motif, but changed the cofactor specificity and the regulated pathway; the other lineage, the ribose repressors (RbsR), changed the DNA motif.

Genome comparisons
Comparative analyses of regulatory sites in related genomes were initially used to identify conserved predicted sites and thus to filter out false positives. It was successfully applied to bacteria and was one of the main reasons prompting the sequencing of multiple yeast genomes [24, 25]. The results were somewhat mixed.

The lists of candidate motifs obtained in the two large-scale comparative studies [24, 25] contained few common motifs, although more robust results were obtained subsequently when phylogenetic footprints were overlaid with genome-wide location data [26••]; in particular, it demonstrated that regulons of many TFs strongly depend on cellular conditions.

Similarly, automated comparative analyses of bacterial genomes produced a considerable amount of false positives. One reason could be frequent shuffling of genes in operons. Taking this possibility into account led to the notion of a regulog, a set of genes regulated by orthologous factors in several genomes [27•].

On the other hand, analysis of individual systems was quite successful and produced numerous experimentally validated predictions. One of the candidate motifs from [26••] was analyzed in detail, leading to the discovery of the NrdR system, which regulates ribonucleotide reductase genes in various bacteria [28•]. This is an example of a completely new system that has been characterized in minute detail solely by comparative analysis. This description includes: the conserved motif; the corresponding TF (identified using phylogenetic co-occurrence patterns); the mode of regulation (repression following cooperative binding to tandem regulatory sites); and the link between this regulon, deoxyribonucleotide salvage and replication (based on the occurrence of candidate sites upstream of DNA ligases, topoisomerases, helicases, replication initiator dnaA and genes involved in chromosome partitioning).

Analyses of particular regulatory systems demonstrated considerable flexibility of both motifs and systems. For example, although the Rpn4p factors that regulate proteasome genes in Saccharomyces cerevisiae and Candida albicans are similar, the nucleotide frequency distributions are significantly different in several positions, as are the binding affinities of the factors for various motifs [29]. On the other hand, the motif is the same in C. albicans and the distant Neurospora crassa genome, whereas the regulons are clearly different.

Analysis of the ribosomal protein (RP) genes in various yeasts demonstrated two types of behavior [30••]. One was the gradual change in the binding motif of the IFHL factor. The other was cooptation of the Rap1p factor after it acquired a new transactivation domain in the last common ancestor of S. cerevisiae and Ashbya gossypii, after branching of C. albicans. The situation is even more complicated because, in S. cerevisiae, genes encoding mitochondrial RPs are co-expressed with stress response genes, whereas in C. albicans, they are co-expressed and co-regulated with cytoplasmic RP and rRNA processing genes [31••]. The regulatory motif responsible for this was lost in mitochondrial RP genes of the S. cerevisiae lineage after the whole-genome duplication event (in particular, it exists in A. gossypii).

Similar striking examples of flexibility in regulatory interactions were observed in analyses of bacterial regulatory systems. Some examples are multiple changes in the regulatory cascades of the aerobic/anaerobic switch and respiration in γ-proteobacteria involving the FNR, ArcA and NarL/NarP TFs (D Ravcheev, A Gerasimova, personal communication); shuffling of regulators of nitrogen oxide metabolism [32]; taxon-specific σE promoters in enterobacteria [33]; and loss and expansion of regulatory systems of amino acid metabolism genes in Gram-positive bacteria (Figure 5). The last system is of particular interest as it involves both TFs and RNA elements; the latter are sufficiently large to reconstruct the history of duplications and horizontal transfers (A Vitreschak, personal communication).

The evolution of TF-binding sites can be studied by considering sites upstream of orthologous genes. As expected, the positional mutation rate negatively correlates with information content, both in yeasts [34] and in bacteria [35]; indeed, the latter is positively correlated with the number of protein–DNA contacts [36] and thus the evolution of such positions is constrained. More surprisingly, non-consensus nucleotides in orthologous sites still tend to be more conserved than expected under a neutral model [37].

Analysis of the co-evolution of TFs and their binding motifs also demonstrates a mosaic of conservation and change. The architecture of binding signals tends to be the same for members of a TF family (palindromes for many families, short direct repeats with a helical pitch periodicity of 10–11 base pairs for two-component systems, overlapping direct and inverted repeats for the FUR family), although changes are possible. For example, the GntR family TFs have both palindromic and direct repeat motifs [38, 39]. The binding motif is conserved for most families that have a single representative per genome, a notable exception being LexA/DinR. For families with numerous representatives, such as LacI and GntR, common features of the binding motifs can be discerned (O Laikova, personal communication and [38], respectively); this may be compared with analogous observations for eukaryotic TF families [40, 41•]. Moreover, analysis of a set of binding sites may allow one to predict the structural class of the TF, at least at the coarse level [41•, 42•]. On the other hand, the analysis of correlations between TFs from one family and their motifs may lead to the identification of structural determinants of specific recognition (Figure 6).

Some open problems
The above discussion shows that analysis of regulatory networks is a very young area developing in a variety of directions. Thus, instead of a conclusion, I would like to list some open problems.
1.
Development of a language for an intermediate level of network topology (interacting motifs, motif complexes).

2.
Further incorporation of post-genomic data (kinase cascades, nucleosome positioning, histone modifications) for yeasts.

3.
Systematic large-scale experimental analysis of protein–DNA interactions in prokaryotes.

4.
Producing models of the evolution of TF families, linking TF family size, phylogenetic distributions and regulon sizes.

5.
Systematic analysis of the evolution of protein–DNA interactions, and the co-evolution of TFs and their DNA motifs.

6.
Incorporation of horizontal transfer into evolutionary models and characterizing metagenomic (common to several strains) TF pools.

7.
Study of the consequences of whole-genome duplications in the yeast genome on the regulatory network; comparison of paralogs arising from this duplication and paralogs stemming from local duplications.

8.
Systematic comparative analysis of complex regulatory systems, collection and generalization of observations, and their use in the construction of realistic models of regulatory network evolution.


